---
layout: default_post
title : docker 与 LNMP（分类：从0开始docker学习）
---


前言：一般我们开发环境需要多个软件配合，平时是在一个系统中，所以不同软件进程中可以互相通信。但是现在是在不同的容器中，不同的容器间的进程是怎么互相访问的呢？

<br>
# 导航
1. 前知条件
1. 安装nginx 
1. 安装mysql
1. 安装php-fpm
1. 容器间互相通信
1. 小demo测试
1. docker-composer
1. 其他
1. 总结

<br>
# 1. 前知条件

首先要知道，docker的 容器通讯 提供了一种别名通讯的做法，确保容器间的通讯依赖的是一个固定的名称，而不是可能会变的 ip 地址。

然后要了解一下两个命令：

- --link

这是一种过时的做法，link 具有方向性，如果需要互相访问就GG。

- --network

官方推荐做法，容器间共同依赖一个网络，从而实现互相访问。




<br>
# 2. 安装 nginx 
拉取镜像：

> docker pull hub.c.163.com/library/nginx:latest

启动容器：

> docker run -p 80:80 –name mynginx -d hub.c.163.com/library/nginx


复制目录：

```
docker container cp 容器名: /usr/share/nginx/html .
docker container cp 容器名: /etc/nginx .
mv nginx conf
docker container cp 容器名: /var/log/nginx/ .
mv nginx log
```

<br>
# 3. 安装 mysql

拉取镜像：
> docker pull hub.c.163.com/library/mysql:latest


启动容器：
> docker run -d -p 3306:3306  –name mysql  -e MYSQL_ROOT_PASSWORD=123456 hub.c.163.com/library/mysql:latest

复制目录：

进到容器内，使用下面命令查看配置文件的位置

> mysql --verbose --help \| grep -A 1 'Default options' 

当然，也可以通过官方文档去查看：

,cnf 文件位置


data 文件位置


错误日志 log 的位置需要自己找一下



最终的复制命令如下：

```
docker container cp mysql:/etc/mysql/conf.d .
docker container cp mysql:/var/lib/mysql .
mv mysql data
docker container cp mysql:/var/log/mysql .
mv mysql log
```



