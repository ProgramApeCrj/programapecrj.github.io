I"<p>前言：虽然之前看过一些设计模式的书或者专栏，但也只是依样画瓢，没有体验过为什么要有设计模式的思维。经历过一次工作中对代码的优化后，终于明白了一丢丢。下面把思路再复现一下。</p>

<h4 id="导航">导航</h4>
<ol>
  <li>场景描述</li>
  <li>暴力写法</li>
  <li>依样画瓢</li>
  <li>考虑演进</li>
  <li>再一次封装</li>
  <li>总结</li>
</ol>

<p><br /></p>
<h1 id="1-场景描述">1. 场景描述</h1>

<p>在开发中，很多时候要收集小程序用户的一些业务上报，比如足迹，点赞，观看时长等等。通过上报后，借助 kafka 来进行消费。</p>

<p>现在的场景是这样的，业务分为多种，会和前端约定相应的key。比如</p>
<ul>
  <li>10001 代表足迹</li>
  <li>10002 代表点赞</li>
  <li>10003 代表支付</li>
  <li>。。。</li>
</ul>

<p>要求对不同 key 都编写对应的一个处理过程，或入库，或做累加等等。。规则也各不相同。</p>

<h1 id="2-暴力写法">2. 暴力写法</h1>

<p>其实上面的场景很简单，上来不用思考就可以写了：</p>

<p>写三个办法分别处理不同的 key</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fun handle10001 {
   // todo 处理逻辑
}

fun handle10002 {
   // todo 处理逻辑
}

fun handle10003 {
   // todo 处理逻辑
}

</code></pre></div></div>
<p>然后消费数据的时候直接调用</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<p><br /></p>
<h1 id="7-总结">7. 总结</h1>
<p>一点小总结</p>

<p>接下来有空要整理一下所有的设计模式</p>
:ET