I"<p>å‰è¨€ï¼šåˆå­¦çš„æ—¶å€™æ€»æ˜¯ä»€ä¹ˆä»€ä¹ˆé›†æˆå¼€å‘ç¯å¢ƒï¼Œæˆ–è€…ç”¨ docker å®‰è£…ï¼Œè¿˜æ²¡å¥½å¥½åœ¨ Linux ä¸‹ç”¨æºç å®‰è£… PHPã€‚ä»Šå¤©å°±æä¸€æŠŠ PHP å®‰è£…å…ˆã€‚</p>

<h4 id="å¯¼èˆª">å¯¼èˆª</h4>
<ol>
  <li>ä¸‹è½½</li>
  <li>ç›¸å…³ä¾èµ–ä¸€è§ˆ</li>
  <li>å®‰è£…å‰çš„é…ç½®</li>
  <li>ç¼–è¯‘</li>
  <li>å®‰è£…</li>
  <li>ç›¸å…³é…ç½®</li>
  <li>æ€»ç»“</li>
</ol>

<p><br /></p>
<h1 id="1-ä¸‹è½½">1. ä¸‹è½½</h1>

<ul>
  <li>å®˜ç½‘åœ°å€ï¼š</li>
</ul>

<blockquote>
  <p>http://php.net</p>
</blockquote>

<ul>
  <li>ä¸‹è½½åœ°å€ï¼š</li>
</ul>

<blockquote>
  <p>http://php.net/downloads.php</p>
</blockquote>

<ul>
  <li>ä¸‹è½½å‘½ä»¤</li>
</ul>

<blockquote>
  <p>wget http://am1.php.net/get/php-7.2.12.tar.gz/from/this/mirror</p>
</blockquote>

<ul>
  <li>è¿›å…¥ä¸‹è½½ç›®å½•ï¼Œè§£å‹ï¼š</li>
</ul>

<blockquote>
  <p>tar -xzf mirror</p>
</blockquote>

<p><br /></p>
<h1 id="2-ç›¸å…³ä¾èµ–ä¸€è§ˆ">2. ç›¸å…³ä¾èµ–ä¸€è§ˆ</h1>

<h4 id="gcc">gcc</h4>

<blockquote>
  <p>yum -y install gcc-c++</p>
</blockquote>

<h4 id="zlib-å’Œ-zlib-devel">zlib å’Œ zlib-devel</h4>

<blockquote>
  <p>yum install zlib</p>
</blockquote>

<blockquote>
  <p>yum install zlib-devel</p>
</blockquote>

<h4 id="libxml2-ä»¥åŠ-libxml2-devel">libxml2 ä»¥åŠ libxml2-devel</h4>

<blockquote>
  <p>yum install  libxml2</p>
</blockquote>

<blockquote>
  <p>yum install libxml2-devel</p>
</blockquote>

<h4 id="libxslt-ä»¥åŠ-libxslt-devel">libxslt ä»¥åŠ libxslt-devel</h4>

<blockquote>
  <p>yum install libxslt</p>
</blockquote>

<blockquote>
  <p>yum install libxslt-devel</p>
</blockquote>

<h4 id="openssl-ä»¥åŠ-openssl-devel">openssl ä»¥åŠ openssl-devel</h4>
<blockquote>
  <p>yum install openssl</p>
</blockquote>

<blockquote>
  <p>yum install  openssl-devel</p>
</blockquote>

<h4 id="jpeg-å’Œ-png">jpeg å’Œ png</h4>

<blockquote>
  <p>yum install libjpeg libpng ibjpeg-devel libpng-devel</p>
</blockquote>

<h4 id="freetype-ä»¥åŠ-freetype-devel">freetype ä»¥åŠ freetype-devel</h4>
<blockquote>
  <p>yum install freetype</p>
</blockquote>

<blockquote>
  <p>yum install  freetype-devel</p>
</blockquote>

<h4 id="gd">gd</h4>
<blockquote>
  <p>yum install gd</p>
</blockquote>

<h4 id="curl">curl</h4>

<blockquote>
  <p>yum install curl</p>
</blockquote>

<blockquote>
  <p>yum install curl-devel</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>æ³¨ï¼š
ä½¿ç”¨ yum list installed  å¯ä»¥æŸ¥çœ‹ä½¿ç”¨ yum å®‰è£…äº†å“ªäº›ä¾èµ–åŒ…
ä½¿ç”¨ rpm -qa | grep xxx å¯ä»¥æŸ¥çœ‹æ˜¯å¦å®‰è£…äº† xxx
xxx-devel æ˜¯ xxx è½¯ä»¶çš„å¼€å‘åŒ…ï¼ŒåŒ…å«å¤´æ–‡ä»¶ä»¥åŠé™æ€åº“ç”šè‡³æºç ã€‚
</code></pre></div></div>

<p><br /></p>
<h1 id="3-å®‰è£…å‰çš„é…ç½®">3. å®‰è£…å‰çš„é…ç½®</h1>

<p><br /></p>
<ul>
  <li>æŸ¥çœ‹å¯ä»¥è‡ªå®šä¹‰çš„é…ç½®ï¼š</li>
</ul>

<blockquote>
  <p>./configure â€“help</p>
</blockquote>

<ul>
  <li>éœ€è¦æ³¨æ„çš„æœ‰å¦‚ä¸‹å‡ ä¸ªï¼š</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--prefix  =  å®‰è£…ç›®å½•

--with-xxx    xxx æ˜¯è¦å®‰è£…çš„æ‹“å±•ã€å¦‚æœæ‹“å±•å·²ç»åœ¨æœ¬åœ°å®‰è£…äº†ï¼Œä¹Ÿå¯ä¹Ÿç”¨ = å»æŒ‡å®šç›®å½•ã€‘

--enable-xxx   xxxæ˜¯éœ€è¦æ¿€æ´»çš„æ‹“å±•åŠŸèƒ½

--with-config-file-path=  php.iniæ–‡ä»¶ä½ç½®

--sysconfdir= å…¶ä»–é…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œä¸æŒ‡å®šé»˜è®¤æ˜¯åœ¨ å®‰è£…ç›®å½• / etc ä¸‹
</code></pre></div></div>

<ul>
  <li>æœ€ç»ˆæ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼ˆæˆ‘è‡ªå®šä¹‰äº†å®‰è£…ç›®å½• å’Œ php.ini çš„ä½ç½®ï¼‰ï¼š</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./configure \
--prefix=/home/install/php/php7 \
--with-config-file-path=/home/install/php/php7-ini \
--with-curl \
--with-freetype-dir \
--with-gd \
--with-gettext \
--with-iconv-dir \
--with-kerberos \
--with-libdir=lib64 \
--with-libxml-dir \
--with-mysqli \
--with-openssl \
--with-pcre-regex \
--with-pdo-mysql \
--with-pdo-sqlite \
--with-pear \
--with-png-dir \
--with-xmlrpc \
--with-xsl \
--with-zlib \
--enable-fpm \
--enable-bcmath \
--enable-libxml \
--enable-inline-optimization \
--enable-mbregex \
--enable-mbstring \
--enable-opcache \
--enable-pcntl \
--enable-shmop \
-enable-soap \
--enable-sockets \
--enable-sysvsem \
--enable-xml \
--enable-zip \
--disable-fileinfo


</code></pre></div></div>

<p>æˆåŠŸåˆ™æç¤º</p>

<p><img src="http://blog.runjichen.com/img/18-10-16@01.png" alt="image" /></p>

<p><br /></p>
<h1 id="4-ç¼–è¯‘">4. ç¼–è¯‘</h1>

<h4 id="æ‰§è¡Œ-ç¼–è¯‘">æ‰§è¡Œ ç¼–è¯‘</h4>

<blockquote>
  <p>make</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>æ³¨æ„ï¼šå¯èƒ½ä¼šå‡ºç° 

make: *** [ext/fileinfo/libmagic/apprentice.lo] Error 1 

æ˜¯å› ä¸ºæœåŠ¡å™¨å†…å­˜ä¸è¶³1Gï¼Œåœ¨ä¸Šé¢é…ç½®æ—¶  ./configure æ—¶åŠ å‚æ•° --disable-fileinfo å³å¯ã€‚
</code></pre></div></div>

<h4 id="æˆåŠŸæç¤º">æˆåŠŸæç¤º</h4>
<p><img src="http://blog.runjichen.com/img/18-10-16@02.png" alt="image" /></p>

<p><br /></p>

<h1 id="5-å®‰è£…">5. å®‰è£…</h1>

<h4 id="æ‰§è¡Œ-å®‰è£…">æ‰§è¡Œ å®‰è£…</h4>

<blockquote>
  <p>make install</p>
</blockquote>

<h4 id="å®‰è£…æˆåŠŸ">å®‰è£…æˆåŠŸ</h4>
<p><img src="http://blog.runjichen.com/img/18-10-16@03.png" alt="image" /></p>

<p><br /></p>
<h1 id="6-ç›¸å…³é…ç½®-å’Œ-å¯åŠ¨">6. ç›¸å…³é…ç½® å’Œ å¯åŠ¨</h1>

<p><br /></p>
<h4 id="æ‹·è´ä¸€ä¸‹é…ç½®ç¤ºä¾‹æ–‡ä»¶-phpini">æ‹·è´ä¸€ä¸‹é…ç½®ç¤ºä¾‹æ–‡ä»¶ php.ini</h4>

<blockquote>
  <p>cp php.ini-development  /home/install/php7-ini/php.ini</p>
</blockquote>

<h4 id="è¿›åˆ°å®‰è£…ç›®å½•çš„-etc-ä¸­">è¿›åˆ°å®‰è£…ç›®å½•çš„ etc ä¸­</h4>

<blockquote>
  <p>cp  php-fpm.conf.default  php-fpm.conf</p>
</blockquote>

<h4 id="è¿›åˆ°å®‰è£…ç›®å½•çš„-etcphp-fpmd-ä¸­">è¿›åˆ°å®‰è£…ç›®å½•çš„ etc/php-fpm.d ä¸­</h4>

<blockquote>
  <p>cp www.conf.default www.confï¼ˆé…ç½®ç”¨æˆ·çš„æ–‡ä»¶ï¼‰</p>
</blockquote>

<h4 id="è¿›åˆ°-sbin-ä¸­-å¯åŠ¨-php-fpm">è¿›åˆ° sbin ä¸­ï¼Œ å¯åŠ¨ php-fpm</h4>

<blockquote>
  <p>./php-fpm</p>
</blockquote>

<h4 id="æŸ¥çœ‹æ˜¯å¦å¯åŠ¨-å…¶å®-php-fpm-æ¨¡å¼å°±æ˜¯å¯åŠ¨ç›‘å¬äº†-9000-ç«¯å£çš„è¿›ç¨‹">æŸ¥çœ‹æ˜¯å¦å¯åŠ¨ (å…¶å® php-fpm æ¨¡å¼ï¼Œå°±æ˜¯å¯åŠ¨ç›‘å¬äº† 9000 ç«¯å£çš„è¿›ç¨‹ã€‚)</h4>

<blockquote>
  <p>ps -ef | grep php</p>
</blockquote>

<h4 id="æ·»åŠ -php-åˆ°ç¯å¢ƒå˜é‡">æ·»åŠ  php åˆ°ç¯å¢ƒå˜é‡</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi  /etc/profile

åœ¨æœ«å°¾åŠ å…¥ï¼š
PATH=$PATH:/home/install/php/php7/bin
export PATH

ä½¿æ”¹åŠ¨ç«‹å³ç”Ÿæ•ˆï¼š
source /etc/profile
</code></pre></div></div>

<h4 id="æŸ¥çœ‹ç‰ˆæœ¬">æŸ¥çœ‹ç‰ˆæœ¬</h4>

<blockquote>
  <p>php -v</p>
</blockquote>

<p><br /></p>
<h1 id="7-æ€»ç»“">7. æ€»ç»“</h1>

<p>æ€»çš„æ¥è¯´ï¼Œéœ€è¦ï¼š</p>
<ol>
  <li>çŸ¥é“æœ‰å“ªäº›ä¾èµ–</li>
  <li>çŸ¥é“å¦‚ä½•è‡ªå®šä¹‰é…ç½®</li>
  <li>æ‰§è¡Œç¼–è¯‘å®‰è£…</li>
  <li>æŒ‰æç¤ºè§£å†³ä¸€äº›ä¾èµ–ã€ç¯å¢ƒé—®é¢˜</li>
  <li>çŸ¥é“å„ç§é…ç½®æ–‡ä»¶çš„ä½ç½®ï¼ŒçŸ¥é“å¦‚ä½•å¯åŠ¨</li>
</ol>

<p><br /></p>
<h5 id="åè¯">åè¯</h5>
<p>å…¶å®å’Œå®‰è£… Nginx å·®ä¸å¤šï¼Œæˆ–è€…è¯´ Linux ä¸‹çš„å®‰è£…éƒ½æ˜¯è¿™ä¸ªæ ·çš„ã€‚æ¥ä¸‹æ¥éœ€è¦å»ç†Ÿæ‚‰ä¸€ä¸‹ä¸€äº›åŸºæœ¬çš„é…ç½®ã€‚</p>
:ET